<!DOCTYPE html>
<html>
<head>
  <link href='https://fonts.googleapis.com/css?family=Raleway:300' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="../stylesheets/default.css">
  <link rel="stylesheet" type="text/css" href="../stylesheets/blog.css">

<title>
  Lisa Buch's DBC blog
  </title>
</head>

<body>
  <main>
    <header class = "entryheader">
 <h3><a href="index.html">back to index</a></h3>
    <h1>Enumerable Methods</h1>
    <h2>99 bottles of beer on the wall, 99 bottles of beer, take one down, pass it around, 98 bottles of beer on the wall...</h2>
    <date>March 12, 2016</date>
    <section id="profile">
      <img src="../imgs/lisablog.png">
      <h4>Lisa Buch</h4>
      <h5><a href="../index.html" target="_blank">view my portfolio</a></h4>
    </section>
    </header>
  <section>
<img src="bottles.jpg" width="400" height="250">
<p>One of Ruby's biggest workhorses is the Enumerable module, allowing you to iterate over blocks of code with ease, speed, and lots of possibilties.</p>

<p>The enumerable module is so handy when you need to perform the same action on each element in a collection (an array, hash, etc.) Normally, we could do this with a "for" or "while" loop, and there's nothing really wrong with that, but there is a shorter and more concise way </p>
<p>Let's say I'm running a beer shop, and all of my inventory is stored in a hash indicating the price, for each item, like so:
  <div class="pre">
  <pre>inventory = {"Heady Topper" => $6.75, "Pliny the Elder" => $7.00, "Mikkeller" => $5.75,"Chimay" => $5.00, "Hoegaarden" => $3.00, "Abita" => $4.00, "Smuttynose" => $3.00}</pre>
</div>
<p>If I'm having a sale, and I want to offer 25% off all beers, all I need to write is:</p>
<div class="pre"><pre>sale_prices = inventory.map { {k => v - (v*0.1) } }</pre></div>
<p>Before I show you the result, let's break down what all of this means first:</p>
<p><img src="map method.jpg" width="550" height="80"></p>
<ol>
  <li><div class="pre"><pre>{|k,v| {k => v - (v*0.1) }}</pre></div></li> is my code block. Here, I signal what elements I'm targeting, and what I'm going to do be doing to them. In this case, I'm targeting my key/value pairs, indicated by the <div class="pre"><pre>|k,v|</pre></div>. I want to reset my values <div class="pre"><pre>v</pre></div> to themselves minus 10% (<div class="pre"><pre> v - (v*.01)</pre></div>)
  <aside>Note: Normally, in a code bloack, you don't need to wrap the behavior you are performing in curly braces, as I did with <div class="pre"><pre>{ {k => v - (v*0.1) } }</pre></div>. Normally, <div class="pre"><pre>.map</pre></div> returns an array, but I want mine to return a hash, since that's what I'm working with. Any other time, you could leave that inner set of curly braces off.</aside>

  <li><div class="pre"><pre>inventory.map</pre></div> Here, I'm using the <div class="pre"><pre>.map</pre></div> method, which belongs to the Enumerable module. <div class="pre"><pre>.map</pre></div> takes the code block passed to it (explained above), and executes that operation on each element in the collection it's called on-- in this case, it's called on my hash "inventory." .map will <b>return a new collection (an array), leaving the original unchanged. After my sale has ended, I can just print my prices stored in <div class="pre"><pre>inventory</pre></div>. How handy! </b> </li>
</ol>
<p>So what do I get when I run this?</p>
<div class="pre"><pre>[{"Heady Topper"=>6.075}, {"Pliny the Elder"=>6.3}, {"Mikkeller"=>5.175}, {"Chimay"=>4.5}, {"Hoegaarden"=>2.7}, {"Abita"=>3.6}, {"Smuttynose"=>2.7}]</pre></div>
  <p> As you can see, it worked! The price of each beer has changed. Great! But, there's a couple things that are off. To start, why is my hash now separated into a bunch of hashes appearing in an array? Also, some of these new prices don't look like prices. They are missing dollar signs, and some have three decimal places instead of two.</p>
  <p>It's important to note that .map <span class="emph">returns a new array</span> with the results the code block ran. My hash is still intact, but it's enclosed in an array. Depending on your goals, this may be absolutely fine, but I'd like to fix it and just return everything in one hash, like my original input. </p>
  <p>Here's what I need to write:</p>
  <div class="pre"><pre>sale_prices = sale_prices.reduce(&:merge)</pre></div>
  <p>Here, I'm utilizing the reduce method, which takes an array and reduces it to one element by applying the argument you pass into it to every item in a collection. In this case, it applies the .mergemethod to everything in my array of hashes-- it combines the first hash with the second hash, that hash with the third hash, that hash with the fourth hash, and so on. The &: in(&:merge) is just a way of calling merge on each element.</p>
  <p>So now my output is:</p>
  <div class="pre"><pre>{"Heady Topper"=>6.075, "Pliny the Elder"=>6.3, "Mikkeller"=>5.175, "Chimay"=>4.5, "Hoegaarden"=>2.7, "Abita"=>3.6, "Smuttynose"=>2.7}</pre></div>
<p>OK, not bad, but I still have my issue of some weird prices. This is an easy fix, thanks to Ruby's .round method! Going back up to my original price-redution enumerator, I just need to add in the .round method to where I calculate my new sale price.</p>
  <div class="pre"><pre>sale_prices = inventory.map {|k,v| {k => v - (v*0.1).round(2) }}</pre></div>

  <p>The (2) argument just specifies that I want to round all my floats to two decimal places.</p>

  <p>What's the final output? Let's take a look!</p>
  <div class="pre"><pre>{"Heady Topper"=>6.07, "Pliny the Elder"=>6.3, "Mikkeller"=>5.17, "Chimay"=>4.5, "Hoegaarden"=>2.7, "Abita"=>3.6, "Smuttynose"=>2.7}</pre></div>

  <p>Gorgeous! I think it's time for a beer.</p>

</main>

<section id="resources"><h3>Helpful links:</h3>
<a href="http://ruby.bastardsbook.com/chapters/enumerables/" _target="_blank">Introduction to enumerables |  </a><a href="http://www.sitepoint.com/guide-ruby-collections-iii-enumerable-enumerator/" target="_blank">A guide to collections</a><h4>back</h4></a>


<a href="index.html">< go back</a>

      </section>

  </body>
  </html>
